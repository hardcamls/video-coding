(* Test forward and inverse DCTs. *)
open Core
open Hardcaml
open Hardcaml_waveterm
module Dct = Hardcaml_jpeg.Dct.Single_multiplier

let%expect_test "test loops" =
  let module Sim = Cyclesim.With_interface (Dct.I) (Dct.O) in
  let sim = Sim.create Dct.create in
  let waves, sim = Waveform.create sim in
  for _ = 0 to 10 do
    Cyclesim.cycle sim
  done;
  Waveform.print waves;
  [%expect
    {|
    ┌Signals────────┐┌Waves──────────────────────────────────────────────┐
    │clock          ││┌───┐   ┌───┐   ┌───┐   ┌───┐   ┌───┐   ┌───┐   ┌──│
    │               ││    └───┘   └───┘   └───┘   └───┘   └───┘   └───┘  │
    │clear          ││                                                   │
    │               ││───────────────────────────────────────────────────│
    │               ││───────────────────────────────────────────────────│
    │read_address   ││ 00                                                │
    │               ││───────────────────────────────────────────────────│
    │               ││───────────────────────────────────────────────────│
    │read_enable    ││ 0                                                 │
    │               ││───────────────────────────────────────────────────│
    │               ││────────────────┬───────┬───────┬───────┬───────┬──│
    │write_address  ││ 00             │01     │02     │03     │04     │05│
    │               ││────────────────┴───────┴───────┴───────┴───────┴──│
    │               ││───────────────────────────────────────────────────│
    │write_coef     ││ 00                                                │
    │               ││───────────────────────────────────────────────────│
    │               ││───────────────────────────────────────────────────│
    │write_enable   ││ 0                                                 │
    └───────────────┘└───────────────────────────────────────────────────┘ |}]
;;
